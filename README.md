# Currency App Flutter

Привет! Это Flutter-приложение для отслеживания стоимости валют. Здесь авторизованные пользователи могут просматривать список из более 160 мировых валют, полученных из [**открытого API**](https://currencybeacon.com/). Также заложен функционал по сохранению "избранных валют" для более удобного отслеживания, а также просмотр подробной информации о валюте, в которую включен график динамики цены. Помимо всего прочего приложение поддерживает Русскую и Английскую локализации, Светлую и Тёмную темы, а также возможен выбор базовой валюты (RUB, KZT, EUR, USD).

<img src="https://github.com/fivenation/currency_app/assets/86624715/cfaf75c7-a651-419b-b050-31f058df3cce" width="200"> <img src="https://github.com/fivenation/currency_app/assets/86624715/e6b33a80-b0cf-4fac-96c4-cdf99bfd1d5c" width="200"> <img src="https://github.com/fivenation/currency_app/assets/86624715/5ed39380-daf2-4f85-a92a-3c6f5847fe36" width="200"> <img src="https://github.com/fivenation/currency_app/assets/86624715/afbae5a8-ab52-47ec-9c3a-b9c1a4c65717" width="200">

Приложение можно пощупать на Android'е по [**ссылке на APK**](https://disk.yandex.ru/d/5gAyYlFIM82AJw), также можно посмотреть [**макет приложения в Figma**](https://www.figma.com/file/2vwFpfibYaoWIUIKdMGJBY/Currency-App-Design?type=design&node-id=0%3A1&mode=design&t=JKQ8GVndvlIDW5uu-1). 

Далее будут описаны интересные моменты реализации приложения, а также некоторые технические решения.

## AppTheme и Utlis

### Дизайн, тема приложения

* Заранее был **создан макет Figma**, по которому потом реализован UI приложения
* В макете выделены все экраны с некоторой вариативностью поведения в двух вариантах - **для светлой и тёмной темы**
* Отедельно обозначены компоненты темы - **Цветовая схема, Иконки, Стили текста**

<img src="https://github.com/fivenation/currency_app/assets/86624715/29c4521d-088d-40d1-8521-bb27fd395469" width="700">

* В самом проекте реализована сущность **ThemeManager**, отвечающая за работу с темой
* Реализована **подгрузка из локального хранилища** сохранённый *ThemeMode*
* Для удобства разработки все цвета, шрифты, стили отдельных компонентов интерфейса **вынесены в константы**
* Сами же ***ColorScheme*** и ***TextStyles*** представлены в виде ***Extention*** для классf *ThemeData*, свой вариант для каждого варианта темы
* Иконки реализованы с помощью сервиса *FlutterIcon*, иконки достаются из созданного шрифта
* Для удобства построения "адаптивного" интерфейса используется пакет ***ScreenUtil***

### Интернационализация

* Для интернационализации использован пакет с кодо-генерацией ***Intl***
* Поддерживаются **Русская и Английская** локализация
* Аналогично с *ThemeMode*, выбраная **локализация кэшируется** в локальное хранилище
* Для удобства работы с типами *DateTime* часто используются форматтеры и парсеры, предложенные Intl

### Логгирование и вывод сообщений

* Для более грамотного и удобного логгированя во время отладки реализован *logger* с помощью пакета **Logger**
* С помощью логгера в удобном и понятном формате в консоль выводятся ошибки, возникающие в процессе выполнения
* Для оповещения об ошибках и предупреждениях реализован ***ScaffoldMessenger***
* Мессендер и логгер реализованы независимо от фреймворка, что позволяет (в случае *ScaffoldMessenger* только при наличии контекста) обращаться из любого слоя

## Presentation Layer

Теперь наверное стоит пройтись по каждому экрану, чтобы разобрать функционал в целом, выделить интересные решения и т. д.

### Страницы Авторизации и Регистрации

<img src="https://github.com/fivenation/currency_app/assets/86624715/bd75005e-d374-4a7e-a6d7-2de3dfe1e7cd" width="175">  <img src="https://github.com/fivenation/currency_app/assets/86624715/d267077f-a5fd-47c4-95c4-8c0fd4cb591d" width="175">  <img src="https://github.com/fivenation/currency_app/assets/86624715/be15c2c9-6a99-47f5-bb60-1ea37e265d45" width="175">  <img src="https://github.com/fivenation/currency_app/assets/86624715/abde55bf-a7cd-4cfe-9fdf-41259782aa9a" width="175">

* В приложении предусмотрена авторизация через ***Email\Password*** и через ***Google*** (которая не совсем работает)
* Реализован **анимированный задний фон** с 3-мя разноцветными волнами разной высоты и скорости
* Все поля при заполнении проходят **валидацию формы**, чтобы избежать примитивных ошибок при отправке формы
* При непрохождении валидации нужные **поля отмечаются**, а снизу выводится сообщение

### Главная страница

<img src="https://github.com/fivenation/currency_app/assets/86624715/339eccc8-d392-4168-84ac-70c459249efd" width="175"> <img src="https://github.com/fivenation/currency_app/assets/86624715/f19a7190-aeeb-4d6e-b1d2-1fa16d4b1a76" width="175">  <img src="https://github.com/fivenation/currency_app/assets/86624715/fc311977-e23c-4218-b5c8-4d6ec8df76f7" width="175">  <img src="https://github.com/fivenation/currency_app/assets/86624715/ed3401d1-908c-4b20-9fc7-76dadb0c6a39" width="175">  <img src="https://github.com/fivenation/currency_app/assets/86624715/d1261c33-f87e-4497-b479-ec1004fca9fa" width="175">

* **Главная страница** представляет из себя весь **список валют с основной информацией** о ней, а также кнопками, позволяющими **отметить интересующие валюты, как *favorites***, список таких валют закреплён в верхней части экрана.
* **Header** страницы анимированый. Сама страница свёрстана на Sliver'ах, для возможности добавления интересных анимаций во время скролла.
* Сверху справа находится кнопка переводящая на экран настроек
* На главной странице реализован **Поиск** по коду валюты, поиск динамический, то есть при введении текста, сразу происходит поиск по введённому тексту

### Страницы деталей и настроек

<img src="https://github.com/fivenation/currency_app/assets/86624715/88f30db1-7238-4b7b-a9a1-422ee4bcdb0d" width="175">  <img src="https://github.com/fivenation/currency_app/assets/86624715/f807abb8-bda2-4fcb-a076-1a3f4b18181a" width="175">  <img src="https://github.com/fivenation/currency_app/assets/86624715/42cd7be5-c9b1-4f62-81f2-29c6cc0a7555" width="175">

* Страница настроек предоставляет возможность увидеть имя текущего пользователя и "выйти из аккаунта", поменять язык локализации, тему, базовую валюту
* Страница деталей представляет из себя страницу с информацией по конкретно выбраной валюте
* С помощью интересного пакета ***Syncfusion Flutter Charts*** был построен график изменения цены выбранной валюты

### Общие заметки по страницам

* ***Навигация*** в приложении сделана с использованием ***Go Router***. Прописан роутер, а также отдельные названия страниц выделены в отдельный класс констант. Навигация производится через обращениие к сущности навигатора.
* Некоторые ***компоненты интерфейса***, которые оказались слишком крупными, ***выделены в отдельные виджеты***, закреплённые за страницей, либо располагающиеся в папке *Common*.
* В нескольких из них обладают эфимерным состоянием, которое управляется Vanila подходом

## Архитектура, логика

Про Архитектуру можно сказать, что она ***Layer-First*** и с намёками на ***Clean Architecture***. Прямых нарушений принципов "чистой" не допущено (вроде бы). Сделано разделение на 4 слоя - utils, presentation, domain, data.

### Управление состоянием, DI

* Для Dependency Injection использовались пакеты ***Get It и Injectable***. Практически все сущности внедряемые, так практически везде отсутствуют явные зависимости на инструментариях.
* **Для разных задач в целом оправдано применялся разный стейт менеджмент***
* Так ещё до *MaterialApp* в дерево через ***MultiProvider*** обозначены зависимости от контроллеров ***состоянием Приложения*** -- например, авторизация, настройки. В **App State** выделены BLoC авторизации, и ChangeNotifier'ы -- *ThemeManager*, *LocaleManager*, *BaseCurrencyNotifier*. В настройках идёт обращение к этим сущностям для изменения состояния приложения.
* Для управления состоянием **Главной страницы** и **Страницы деталей** использовался ***BLoC***. Ивенты и стейты прописаны с применением ***Freezed***.

### Сущности, Data-слой

* Для ***каждой сущности*** (SummaryData, UserData, CurrencyData, Preferences) реализованы модели с ***применением Freezed и JsonSerializable***
* Репозитории имеют абстракции и реализованы с применением уже data source'ов
* Для авторизации существует отдельный "репозиторий авторизации", что в целом является грамотным решением в данном случае
* Для данных полученых с API или локального хранилища созданы специальные ***DTO*** (например, HiveObjcts) и соответственно созданы *Mapper'ы* этих данных из DTO в Entety
* ***Для работы с API*** использовался пакет ***DIO***. Был выделен в отдельную сущность ***DioService***
* ***Для работы с Локальных хранилищем*** использовался плагин ***Hive***

## Интересные фичи

Есть фичи, которые трудно как-то выделить в какую-то из этих категорий, поэтому записаны они тут

* ***Firebase Crashlytics*** -- в приложение внедрён сервис по сбору ошибок (всё работает, NullPointerExeption приходит (Нет))
* ***Offline-First*** -- В приложении предусмотрены варианты отсутствия соединения с интернетом. Делается это с помощью проверки в нужных местах на соединение с помощью ***Connectivity Plus***. Например, в случае когда ***отсутствует интернет***, данные просто берутся из ***локального хранилища**, а если это ***действие или данные, зависящие от интернета***, то доступ к ним ***блокируется***(например, кнопки не работают). Так, кстати, при отсутствии интернета, невозможно поменять Base Currency или перейти на страницу деталей валюты.
* ***Offline-Авторизация*** -- Тоже реализовано. Войдя в приложение при наличии интернета, информация о пользователе и его "авторизованности" кэшируется в Hive, соотвественно при отсутствии интернета, действует допуск в приложение.

<hr>


В общем получился самый настоящий финтех  :)

<img src="https://github.com/fivenation/currency_app/assets/86624715/9b20a6da-2ef4-426d-9c15-0775072e4b4c" width="600">


